<!DOCTYPE html><html><head><title>Draylar's Blog | Minecraft Mapper</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><meta name="robots" content="index,follow"><meta name="theme-color" content="#212121"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link href="https://fonts.googleapis.com/css?family=Hind:400,700&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:300,400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/icon?family=Material+Icons|Material+Icons+Outlined" rel="stylesheet"><style>
      body, input, button {
        font-family: 'Hind', sans-serif;
      }

      code, .hljs {
        font-family: 'Source Code Pro', 'Courier New', Courier, monospace;
      }

      .icon-font {
        font-family: 'Material Icons';
        font-weight: normal;
        font-style: normal;
        font-size: 24px;  /* Preferred icon size */
        display: inline-block;
        line-height: 1;
        text-transform: none;
        letter-spacing: normal;
        word-wrap: normal;
        white-space: nowrap;
        direction: ltr;
      
        /* Support for all WebKit browsers. */
        -webkit-font-smoothing: antialiased;
        /* Support for Safari and Chrome. */
        text-rendering: optimizeLegibility;
      
        /* Support for Firefox. */
        -moz-osx-font-smoothing: grayscale;
      
        /* Support for IE. */
        font-feature-settings: 'liga';
      }

      .icon-font.outline {
        font-family: 'Material Icons Outlined';
      }
    </style><link href="/docs/assets/codedoc-styles.css" rel="stylesheet"><script async="" defer="" src="/docs/assets/codedoc-bundle.js"></script></head><body><div class="header-0-0-5"><a class="watermark-0-0-4" href="https://github.com/CONNECT-platform/codedoc" target="_blank">Created With<svg viewBox="0 0 536 296" version="1.1" xmlns="http://www.w3.org/2000/svg"><g id="codedoc" transform="translate(-244.000000, -364.000000)" fill-rule="nonzero"><path d="M580,532 C615.346224,532 644,560.653776 644,596 C644,631.346224 615.346224,660 580,660 C544.653776,660 516,631.346224 516,596 C516,560.653776 544.653776,532 580,532 Z M716,532 C751.346224,532 780,560.653776 780,596 C780,631.346224 751.346224,660 716,660 L692,660 C687.581722,660 684,656.418278 684,652 C684,647.581722 687.581722,644 692,644 L716,644 C742.509668,644 764,622.509668 764,596 C764,569.490332 742.509668,548 716,548 L692,548 C687.581722,548 684,544.418278 684,540 C684,535.581722 687.581722,532 692,532 L716,532 Z M468,532 C472.418278,532 476,535.581722 476,540 L476,652 C476,656.418278 472.418278,660 468,660 L444,660 C408.653776,660 380,631.346224 380,596 C380,560.653776 408.653776,532 444,532 L468,532 Z M332,532 C336.418278,532 340,535.581722 340,540 L340,652 C340,656.418278 336.418278,660 332,660 L252,660 C247.581722,660 244,656.418278 244,652 L244,540 C244,535.581722 247.581722,532 252,532 L332,532 Z M580,548 C553.490332,548 532,569.490332 532,596 C532,622.509668 553.490332,644 580,644 C606.509668,644 628,622.509668 628,596 C628,569.490332 606.509668,548 580,548 Z M461,548 L444,548 C417.490332,548 396,569.490332 396,596 C396,622.509668 417.490332,644 444,644 L461,644 L461,548 Z M444,364 C479.346224,364 508,392.653776 508,428 C508,463.346224 479.346224,492 444,492 C408.653776,492 380,463.346224 380,428 C380,392.653776 408.653776,364 444,364 Z M332,364 C336.418278,364 340,367.581722 340,372 C340,376.418278 336.418278,380 332,380 L308,380 C281.490332,380 260,401.490332 260,428 C260,454.509668 281.490332,476 308,476 L332,476 C336.418278,476 340,479.581722 340,484 C340,488.418278 336.418278,492 332,492 L308,492 C272.653776,492 244,463.346224 244,428 C244,392.653776 272.653776,364 308,364 L332,364 Z M580,364 C615.346224,364 644,392.653776 644,428 C644,463.346224 615.346224,492 580,492 L556,492 C551.581722,492 548,488.418278 548,484 L548,372 C548,367.581722 551.581722,364 556,364 L580,364 Z M772,364 C776.418278,364 780,367.581722 780,372 C780,376.418278 776.418278,380 772,380 L700,380 L700,420 L772,420 C776.418278,420 780,423.581722 780,428 C780,432.418278 776.418278,436 772,436 L700,436 L700,476 L772,476 C776.418278,476 780,479.581722 780,484 C780,488.418278 776.418278,492 772,492 L692,492 C687.581722,492 684,488.418278 684,484 L684,372 C684,367.581722 687.581722,364 692,364 L772,364 Z M444,380 C417.490332,380 396,401.490332 396,428 C396,454.509668 417.490332,476 444,476 C470.509668,476 492,454.509668 492,428 C492,401.490332 470.509668,380 444,380 Z M580,380 L563,380 L563,476 L580,476 C606.509668,476 628,454.509668 628,428 C628,401.490332 606.509668,380 580,380 Z"></path></g></svg></a></div><div id="-codedoc-container" class="container"><h1 id="minecraft-mapper" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Minecraft Mapper</h1><p><a href="https://github.com/Draylar/minecraft-mapper">Minecraft Mapper</a> is a project I made while attempting to learn JavaScript and NodeJS. </p><p><img src="https://camo.githubusercontent.com/3a03f1eaba7ea1454dc50a8bc902b89a6e42597f/68747470733a2f2f692e696d6775722e636f6d2f3856477077576d2e706e67" alt=""></p><p>The idea behind this project was simple: paste your game log or code mapped in <a href="https://github.com/FabricMC/intermediary">Intermediary</a> to the text box, and it will spit back a mapped
log! This is helpful for developers trying to find the mapped version of intermediary code lines &amp; clues users into what might be going wrong with their game.</p><pre class=""><code class="js code-0-0-11" tabindex="0"><span class="wmbar-0-0-14"><span></span><span></span><span></span><span></span></span><div class="line-0-0-13 " data-content="class_310 => MinecraftClient"><span class="lineCounter-0-0-12 prim">1</span><span class="token parameter">class_310</span> <span class="token operator">=&gt;</span> MinecraftClient</div><br></code></pre><p>The not-so-simple part of the project is the fact that it automatically downloads the latest mappings for <em>each game version</em>, allowing you to pick what version your log should be mapped to. 
This is done by checking the <a href="https://meta.fabricmc.net/">Fabric meta API</a> for versions every 24 hours, then either keeping, updating, or installing each version depending on the version cached already. Versions are separated by a folder and have a file for information on the mappings (mainly used for build info to update if needed), plus the actual mappings file. I'm also rolling a simple custom parser for the .tiny mapping files yarn uses. </p><p>This project can <em>also</em> be used to map mod jars when source isn't posted (don't worry, this is my code):</p><pre class="with-bar"><code class="java code-0-0-11" tabindex="0"><span class="wmbar-0-0-14"><span></span><span></span><span></span><span></span></span><div class="line-0-0-13 " data-content="DIAMOND(3, 1561 * VanillaHammers.CONFIG.durabilityModifier, 2.2857144F, 0.0F, 10, () -> {"><span class="lineCounter-0-0-12 prim">1</span><span class="token function">DIAMOND</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1561</span> <span class="token operator">*</span> <span class="token class-name">VanillaHammers</span><span class="token punctuation">.</span>CONFIG<span class="token punctuation">.</span>durabilityModifier<span class="token punctuation">,</span> <span class="token number">2.2857144F</span><span class="token punctuation">,</span> <span class="token number">0.0F</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="    return class_1856.method_8091(new class_1935[]{class_1802.field_8477});"><span class="lineCounter-0-0-12">2</span>    <span class="token keyword">return</span> class_1856<span class="token punctuation">.</span><span class="token function">method_8091</span><span class="token punctuation">(</span><span class="token keyword">new</span> class_1935<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>class_1802<span class="token punctuation">.</span>field_8477<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="}),"><span class="lineCounter-0-0-12 prim">3</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span></div><br></code></pre><p>Turns into...</p><pre class="with-bar"><code class="java code-0-0-11" tabindex="0"><span class="wmbar-0-0-14"><span></span><span></span><span></span><span></span></span><div class="line-0-0-13 " data-content="DIAMOND(3, 1561 * VanillaHammers.CONFIG.durabilityModifier, 2.2857144F, 0.0F, 10, () -> {"><span class="lineCounter-0-0-12 prim">1</span><span class="token function">DIAMOND</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1561</span> <span class="token operator">*</span> <span class="token class-name">VanillaHammers</span><span class="token punctuation">.</span>CONFIG<span class="token punctuation">.</span>durabilityModifier<span class="token punctuation">,</span> <span class="token number">2.2857144F</span><span class="token punctuation">,</span> <span class="token number">0.0F</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="    return Ingredient.ofItems(new ItemConvertible[]{Items.DIAMOND});"><span class="lineCounter-0-0-12">2</span>    <span class="token keyword">return</span> <span class="token class-name">Ingredient</span><span class="token punctuation">.</span><span class="token function">ofItems</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ItemConvertible</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token class-name">Items</span><span class="token punctuation">.</span>DIAMOND<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="}),"><span class="lineCounter-0-0-12 prim">3</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span></div><br></code></pre><p>I started by watching a <a href="https://www.youtube.com/watch?v=JnEH9tYLxLk">Full Stack introduction video by The Coding Train &amp; Coding Garden</a>, but transitioned over to relying on
stackoverflow and Mozilla JS docs once I got a feel for things. </p><h3 id="design-process" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Design Process</h3><p>When I started with the project, I had a vision, but no idea on implementation. As time went on and I learned more about the structure of my soon-to-be project, I started to formulate a game plan and deeper structure for how the system would operate.</p><p>My initial plan was fairly straightforward: send the mappings to the server, have it replace certain phrases with their mapped equivalents, and then send it back to the client.</p><p><strong>First roadblock: how do we read mapping files?</strong></p><p>I had a .tiny mapping file in my project directory, and the basic C2S/S2C interactions setup, but I needed a way to <em>load</em> mappings into a basic file.</p><p>I started with a basic implementation: read the file, split it at the newline, and check if each line starts with a certain phrase (for classes/fields/methods). I would then save it in a map between intermediary &amp; yarn mapped versions.</p><p><em>Note: the following code blocks are curated snippets of the important code in pseudo-JS, not 1:1 to the project.</em></p><pre class="with-bar"><code class="javascript code-0-0-11" tabindex="0"><span class="wmbar-0-0-14"><span></span><span></span><span></span><span></span></span><div class="line-0-0-13 " data-content="function loadData() {"><span class="lineCounter-0-0-12 prim">1</span><span class="token keyword">function</span> <span class="token function">loadData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="    dir.readFiles("><span class="lineCounter-0-0-12">2</span>    dir<span class="token punctuation">.</span><span class="token function">readFiles</span><span class="token punctuation">(</span></div><br><div class="line-0-0-13 " data-content="        &quot;mappings&quot;,"><span class="lineCounter-0-0-12">3</span>        <span class="token string">"mappings"</span><span class="token punctuation">,</span></div><br><div class="line-0-0-13 " data-content="        function (err, context, next) {"><span class="lineCounter-0-0-12">4</span>        <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> context<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="            .../"><span class="lineCounter-0-0-12 prim">5</span>            <span class="token operator">...</span><span class="token operator">/</span></div><br><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12">6</span></div><br><div class="line-0-0-13 " data-content="            content.split(&quot;\n&quot;).forEach(element -> {"><span class="lineCounter-0-0-12">7</span>            content<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>element <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="                // collect information from split lines"><span class="lineCounter-0-0-12">8</span>                <span class="token comment">// collect information from split lines</span></div><br><div class="line-0-0-13 " data-content="                var lines = element.trim().split(&quot; &quot;); // type / intermediary / yarn"><span class="lineCounter-0-0-12">9</span>                <span class="token keyword">var</span> lines <span class="token operator">=</span> element<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// type / intermediary / yarn</span></div><br><div class="line-0-0-13 " data-content="                var type = [...]; // (either CLASS, METHOD, or FIELD)"><span class="lineCounter-0-0-12 prim">10</span>                <span class="token keyword">var</span> type <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// (either CLASS, METHOD, or FIELD)</span></div><br><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12">11</span></div><br><div class="line-0-0-13 " data-content="                if(type == &quot;CLASS&quot;) {"><span class="lineCounter-0-0-12">12</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token string">"CLASS"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="                    // save class"><span class="lineCounter-0-0-12">13</span>                    <span class="token comment">// save class</span></div><br><div class="line-0-0-13 " data-content="                } else if (type == &quot;METHOD&quot;) {"><span class="lineCounter-0-0-12">14</span>                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token string">"METHOD"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="                    // save method"><span class="lineCounter-0-0-12 prim">15</span>                    <span class="token comment">// save method</span></div><br><div class="line-0-0-13 " data-content="                } else if (type == &quot;FIELD&quot;) {"><span class="lineCounter-0-0-12">16</span>                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token string">"FIELD"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="                    // save field"><span class="lineCounter-0-0-12">17</span>                    <span class="token comment">// save field</span></div><br><div class="line-0-0-13 " data-content="                }"><span class="lineCounter-0-0-12">18</span>                <span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content="            });"><span class="lineCounter-0-0-12">19</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="        },"><span class="lineCounter-0-0-12 prim">20</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span></div><br><div class="line-0-0-13 " data-content="        .../"><span class="lineCounter-0-0-12">21</span>        <span class="token operator">...</span><span class="token operator">/</span></div><br><div class="line-0-0-13 " data-content="    )"><span class="lineCounter-0-0-12">22</span>    <span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content="}"><span class="lineCounter-0-0-12 prim">23</span><span class="token punctuation">}</span></div><br></code></pre><p>After getting a request from the user, I would use the power of regex to find phrases to replace, look for them in the mapping list, replace them, and send the log back to the user:</p><pre class="with-bar"><code class="javascript code-0-0-11" tabindex="0"><span class="wmbar-0-0-14"><span></span><span></span><span></span><span></span></span><div class="line-0-0-13 " data-content="const methodRegex = /(method_[1-9])\d{0,}/g;"><span class="lineCounter-0-0-12 prim">1</span><span class="token keyword">const</span> methodRegex <span class="token operator">=</span> <span class="token regex">/(method_[1-9])\d{0,}/g</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12">2</span></div><br><div class="line-0-0-13 " data-content="app.post('submit', (req, res) => {"><span class="lineCounter-0-0-12">3</span>app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'submit'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="    var log = req.body.data;"><span class="lineCounter-0-0-12">4</span>    <span class="token keyword">var</span> log <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>data<span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="    var methodMatches = log.match(methodRegex);"><span class="lineCounter-0-0-12 prim">5</span>    <span class="token keyword">var</span> methodMatches <span class="token operator">=</span> log<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>methodRegex<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12">6</span></div><br><div class="line-0-0-13 " data-content="    // see if we hit any matches"><span class="lineCounter-0-0-12">7</span>    <span class="token comment">// see if we hit any matches</span></div><br><div class="line-0-0-13 " data-content="    if(methodMatches !== null) {"><span class="lineCounter-0-0-12">8</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>methodMatches <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="        methodMatches.forEach(match => {"><span class="lineCounter-0-0-12">9</span>        methodMatches<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">match</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="            var replacement = methods.get(match);"><span class="lineCounter-0-0-12 prim">10</span>            <span class="token keyword">var</span> replacement <span class="token operator">=</span> methods<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>match<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12">11</span></div><br><div class="line-0-0-13 " data-content="            // replace match in log with yarn mapping"><span class="lineCounter-0-0-12">12</span>            <span class="token comment">// replace match in log with yarn mapping</span></div><br><div class="line-0-0-13 " data-content="            if(replacement !== undefined) {"><span class="lineCounter-0-0-12">13</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>replacement <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="                log = log.replace(match, replacement);"><span class="lineCounter-0-0-12">14</span>                log <span class="token operator">=</span> log<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>match<span class="token punctuation">,</span> replacement<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="            }"><span class="lineCounter-0-0-12 prim">15</span>            <span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content="        });"><span class="lineCounter-0-0-12">16</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="    }"><span class="lineCounter-0-0-12">17</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12">18</span></div><br><div class="line-0-0-13 " data-content="    // respond with mapped log"><span class="lineCounter-0-0-12">19</span>    <span class="token comment">// respond with mapped log</span></div><br><div class="line-0-0-13 " data-content="    response.json({"><span class="lineCounter-0-0-12 prim">20</span>    response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="        log: log"><span class="lineCounter-0-0-12">21</span>        log<span class="token operator">:</span> log</div><br><div class="line-0-0-13 " data-content="    });"><span class="lineCounter-0-0-12">22</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="});"><span class="lineCounter-0-0-12 prim">23</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br></code></pre><p><strong>Second roadblock: how do we find and separate versions?</strong>:</p><p>I needed to find a way to give the program mapping files once it had been ran outside my environment. I didn't feel right shipping the direct mapping files inside my project (even if yarn <em>is</em> CC0-1.0), and I would have to manually update the file every time new updates came out. I ended up attempting to use the <a href="https://developer.github.com/v3/">GitHub v3 API</a> to download files directly from the yarn repository. I asked the branches endpoint (<code>https://api.github.com/repos/{org}/{project}/branches</code>) to gather a list of all game versions yarn supported (as yarn has a separate branch for each major game version).</p><pre class="with-bar"><code class="javascript code-0-0-11" tabindex="0"><span class="wmbar-0-0-14"><span></span><span></span><span></span><span></span></span><div class="line-0-0-13 " data-content="const githubBranchEndpoint = &quot;https://api.github.com/repos/FabricMC/yarn/branches&quot;;"><span class="lineCounter-0-0-12 prim">1</span><span class="token keyword">const</span> githubBranchEndpoint <span class="token operator">=</span> <span class="token string">"https://api.github.com/repos/FabricMC/yarn/branches"</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="const mappingDirectory = &quot;../mappings&quot;;"><span class="lineCounter-0-0-12">2</span><span class="token keyword">const</span> mappingDirectory <span class="token operator">=</span> <span class="token string">"../mappings"</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12">3</span></div><br><div class="line-0-0-13 " data-content="function updateMappings() {"><span class="lineCounter-0-0-12">4</span><span class="token keyword">function</span> <span class="token function">updateMappings</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="    fetch(githubBranchEndpoint)"><span class="lineCounter-0-0-12 prim">5</span>    <span class="token function">fetch</span><span class="token punctuation">(</span>githubBranchEndpoint<span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content="        .then(response => response.json())"><span class="lineCounter-0-0-12">6</span>        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content="        .then(versions => {"><span class="lineCounter-0-0-12">7</span>        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">versions</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="            versions.forEach(version => {"><span class="lineCounter-0-0-12">8</span>            versions<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">version</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="                var dir = mappingDirectory = &quot;/&quot; + version.name;"><span class="lineCounter-0-0-12">9</span>                <span class="token keyword">var</span> dir <span class="token operator">=</span> mappingDirectory <span class="token operator">=</span> <span class="token string">"/"</span> <span class="token operator">+</span> version<span class="token punctuation">.</span>name<span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="                var dirFile = dir + &quot;/info.txt&quot;;"><span class="lineCounter-0-0-12 prim">10</span>                <span class="token keyword">var</span> dirFile <span class="token operator">=</span> dir <span class="token operator">+</span> <span class="token string">"/info.txt"</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12">11</span></div><br><div class="line-0-0-13 " data-content="                if(!fs.existsSync(dir)) {"><span class="lineCounter-0-0-12">12</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>fs<span class="token punctuation">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span>dir<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="                    fs.mkdirSync(dir);"><span class="lineCounter-0-0-12">13</span>                    fs<span class="token punctuation">.</span><span class="token function">mkdirSync</span><span class="token punctuation">(</span>dir<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="                    fs.writeFile(dirFile, JSON.stringify(version), function(err) {"><span class="lineCounter-0-0-12">14</span>                    fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>dirFile<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>version<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="                        if(err) throw err;"><span class="lineCounter-0-0-12 prim">15</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="                        console.log(&quot;Created info file for &quot;, version.name);"><span class="lineCounter-0-0-12">16</span>                        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Created info file for "</span><span class="token punctuation">,</span> version<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="                    });"><span class="lineCounter-0-0-12">17</span>                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="                }"><span class="lineCounter-0-0-12">18</span>                <span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content="            });"><span class="lineCounter-0-0-12">19</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="        });"><span class="lineCounter-0-0-12 prim">20</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="}"><span class="lineCounter-0-0-12 prim">21</span><span class="token punctuation">}</span></div><br></code></pre><p>At this point, the system would create a folder for each version, but how would I actually get the mapping files? Turns out the GitHub API... doesn't really support downloading individual files like that, so I went to the Fabric Discord to ask for help. I was told about the <a href="https://meta.fabricmc.net/">FabricMC meta API</a>, which has an endpoint specifically for getting yarn versions. I was <em>also</em> made aware of the <a href="http://maven.fabricmc.net/">FabricMC maven</a>, which hosts all mapping files in jars, and I went, "<em>wait, why don't I just download from this directly?"</em></p><p><strong>Third roadblock: downloading jars and extracting their contents.</strong></p><p>Retrieving versions from the FabricMC API was easy enough, but I also needed to download the files from the maven. </p><p>My first concern while downloading was keeping it reasonable. I didn't want to do anything ridiculous like download <em>every</em> version (~110 as of the current date) jar, every day, to keep up with updates &amp; new versions. I eventually noticed something in each version block in the FabricMC API <code>versions</code> endpoint:</p><pre class="with-bar"><code class="json code-0-0-11" tabindex="0"><span class="wmbar-0-0-14"><span></span><span></span><span></span><span></span></span><div class="line-0-0-13 " data-content="  {"><span class="lineCounter-0-0-12 prim">1</span>  <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="    &quot;gameVersion&quot;: &quot;19w02a&quot;,"><span class="lineCounter-0-0-12">2</span>    <span class="token property">"gameVersion"</span><span class="token operator">:</span> <span class="token string">"19w02a"</span><span class="token punctuation">,</span></div><br><div class="line-0-0-13 " data-content="    &quot;separator&quot;: &quot;.&quot;,"><span class="lineCounter-0-0-12">3</span>    <span class="token property">"separator"</span><span class="token operator">:</span> <span class="token string">"."</span><span class="token punctuation">,</span></div><br><div class="line-0-0-13 highlight" data-content="    &quot;build&quot;: 28,"><span class="lineCounter-0-0-12">4</span>    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span></div><br><div class="line-0-0-13 " data-content="    &quot;maven&quot;: &quot;net.fabricmc:yarn:19w02a.28&quot;,"><span class="lineCounter-0-0-12 prim">5</span>    <span class="token property">"maven"</span><span class="token operator">:</span> <span class="token string">"net.fabricmc:yarn:19w02a.28"</span><span class="token punctuation">,</span></div><br><div class="line-0-0-13 " data-content="    &quot;version&quot;: &quot;19w02a.28&quot;,"><span class="lineCounter-0-0-12">6</span>    <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"19w02a.28"</span><span class="token punctuation">,</span></div><br><div class="line-0-0-13 " data-content="    &quot;stable&quot;: true"><span class="lineCounter-0-0-12">7</span>    <span class="token property">"stable"</span><span class="token operator">:</span> <span class="token boolean">true</span></div><br><div class="line-0-0-13 " data-content="  }"><span class="lineCounter-0-0-12 prim">8</span>  <span class="token punctuation">}</span></div><br></code></pre><p>Hey, I can just keep track of the cached jar build version, and <em>only</em> update it if the one on the endpoint is new!</p><p>My system ended up using a simple queue to slow down my downloads. I would check each version, see if it needed updating or installation, and then put it into a download queue.
Once I finished checking all versions, I would download each jar 10 seconds apart, extract the contents, pull out the mappings file, and delete the extra junk. The data loader would run, parse information from all version mapping files, and everything would be good to go!</p><pre class="with-bar"><code class="javascript code-0-0-11" tabindex="0"><span class="wmbar-0-0-14"><span></span><span></span><span></span><span></span></span><div class="line-0-0-13 " data-content="function queueDownloads(toDownload) {"><span class="lineCounter-0-0-12 prim">1</span><span class="token keyword">function</span> <span class="token function">queueDownloads</span><span class="token punctuation">(</span><span class="token parameter">toDownload</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="    setTimeout(function () {"><span class="lineCounter-0-0-12">2</span>    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="        if (toDownload.length !== 0) {"><span class="lineCounter-0-0-12">3</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>toDownload<span class="token punctuation">.</span>length <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="            var downloadInfo = toDownload.pop();"><span class="lineCounter-0-0-12">4</span>            <span class="token keyword">var</span> downloadInfo <span class="token operator">=</span> toDownload<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="            console.log(&quot;Starting download for&quot;, JSON.stringify(downloadInfo));"><span class="lineCounter-0-0-12 prim">5</span>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Starting download for"</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>downloadInfo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="            downloadJar(downloadInfo);"><span class="lineCounter-0-0-12">6</span>            <span class="token function">downloadJar</span><span class="token punctuation">(</span>downloadInfo<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12">7</span></div><br><div class="line-0-0-13 " data-content="            // queue next download if needed"><span class="lineCounter-0-0-12">8</span>            <span class="token comment">// queue next download if needed</span></div><br><div class="line-0-0-13 " data-content="            if (toDownload.length !== 0) {"><span class="lineCounter-0-0-12">9</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>toDownload<span class="token punctuation">.</span>length <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="                queueDownloads(toDownload);"><span class="lineCounter-0-0-12 prim">10</span>                <span class="token function">queueDownloads</span><span class="token punctuation">(</span>toDownload<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="            }"><span class="lineCounter-0-0-12">11</span>            <span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content="        } else {"><span class="lineCounter-0-0-12">12</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="            console.log(&quot;Finished downloading all yarn jars.&quot;);"><span class="lineCounter-0-0-12">13</span>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Finished downloading all yarn jars."</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="        }"><span class="lineCounter-0-0-12">14</span>        <span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content="    }, 1000 * 10);"><span class="lineCounter-0-0-12 prim">15</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="}"><span class="lineCounter-0-0-12 prim">16</span><span class="token punctuation">}</span></div><br></code></pre><p>The actual unzipping of the file was painful and long, mostly because I still didn't know the full difference between <code>async</code> and `sync (more on that later). This was the hardest part of the project and is what made up most of my development time. </p><p><strong>Fourth &amp; final roadblock: wait, this code is ugly.</strong></p><p>There comes a moment in every project where you realize everything you've written is bad and needs a full rewrite. For me, it was when it took multiple seconds to find the method I needed in my server <code>index.js</code> file. I never ended up rewriting anything, but I did "modularize" the project out into:</p><ul><li><code>index.js</code>, the main driver of the program</li><li><code>mappingDownloader.js</code>, responsible for downloading and updating jars</li><li><code>mappingManager.js</code>, which holds information on all version mappings</li><li><code>mappingParser.js</code>, used to parse downloaded mapping files</li></ul><p>I dislike how "modularization" is handled in NodeJS/JS, but that might just be due to my prior experience in Java (where <em>everything</em> has a separate class). It seemed rather difficulty to extract stuff out to different files, and VSCode did absolutely nothing to help me. It took 30 runs to get rid of all the import errors Java would usually catch before even compiling the project (yes, language differences, still annoying).</p><h3 id="thoughts-on-tooling" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Thoughts on Tooling</h3><p>From a language standpoint, getting to learn <strong>JavaScript</strong> has been a blessing and a curse. </p><p>On one hand, I like the feeling of writing JS. 
It flows nicely, and being able to write code without worrying about things like classes (I just stuck all my methods in index.js to start) and getters &amp; setters for data (you just call the data by name) was nice. In other words, I felt like I could deal more with actually writing code &amp; logic than dealing with the <em>structure</em> of the program.</p><pre class=""><code class="js code-0-0-11" tabindex="0"><span class="wmbar-0-0-14"><span></span><span></span><span></span><span></span></span><div class="line-0-0-13 " data-content="console.log(&quot;Hello, world!&quot;);"><span class="lineCounter-0-0-12 prim">1</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Hello, world!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br></code></pre><p>On the flip side, my experience with JavaScript IDE integration in VSCode was poor (there's a good chance I just have it set up incorrectly). I should prefix this by saying I enjoyed using VSCode for what was mostly my first major time, and would not put the blame on it.  </p><p>For the most part, default suggestions <em>did</em> work. If I start typing a field I have already accessed somewhere else in the file, it'll show up as a suggestion. Same goes for <em>some</em> standard methods. The problem is when you have certain variables that don't have a definitive type, there are <em>no</em> suggestions on it. I'm familiar with IntelliJ + Java, where you see the perfect list of suggestions, with everything being available, and the top-most options being the most relevant to the current context of your code (vs. JS/VSCode where I spent a lot of time trying to figure out what methods even existed online).</p><p>In other words, I'm going to try this "TypeScript" thing out for my next project. :)</p><p><strong>NodeJS and Express</strong> were fun to use and explore. I had heard of the dreaded <em>node_modules</em> folder in the past, and I can see why it might be memed on, but npm still worked well for me.</p><marker><img src="/docs/assets/images/node_modules_meme.png" alt="drawing" width="400">

</marker><p>If I had to compare npm to Gradle (from the Java ecosystem), I would say they rank similarly, with npm being a tad bit better. npm's ease of use is much better than 
constantly struggling to get Gradle to download the right dependency... npm install <em>xyz</em> and you're done (or maybe I've just missed the bad stuff?). One thing that I do prefer
about Gradle is that it <em>seems to</em> (I've been using npm for a week, so I am 100% missing things) make it easier to see <em>what</em> you have installed. npm is like... okay, what all
did I install again?</p><p>Having different logic in separated npm modules is nice, but annoying when you want to do file IO and need 5 separate libraries for each specific task.</p><pre class=""><code class="js code-0-0-11" tabindex="0"><span class="wmbar-0-0-14"><span></span><span></span><span></span><span></span></span><div class="line-0-0-13 " data-content="npm install everything"><span class="lineCounter-0-0-12 prim">1</span>npm install everything</div><br></code></pre><p>Express was easy to get started with and easy to expand on. I was shocked at how <em>little</em> I needed to make a simple request! Adding rate limiting was 5 extra lines at most:</p><pre class="with-bar"><code class="js code-0-0-11" tabindex="0"><span class="wmbar-0-0-14"><span></span><span></span><span></span><span></span></span><div class="line-0-0-13 " data-content="const rateLimit = require('express-rate-limit');"><span class="lineCounter-0-0-12 prim">1</span><span class="token keyword">const</span> rateLimit <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express-rate-limit'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="const app = express();"><span class="lineCounter-0-0-12">2</span><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12">3</span></div><br><div class="line-0-0-13 " data-content="app.use(rateLimt({"><span class="lineCounter-0-0-12">4</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">rateLimt</span><span class="token punctuation">(</span><span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="    windowMs: 10 * 1000, // 10 seconds"><span class="lineCounter-0-0-12 prim">5</span>    windowMs<span class="token operator">:</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token comment">// 10 seconds</span></div><br><div class="line-0-0-13 " data-content="    max: 1 // max requests per windowMs"><span class="lineCounter-0-0-12">6</span>    max<span class="token operator">:</span> <span class="token number">1</span> <span class="token comment">// max requests per windowMs</span></div><br><div class="line-0-0-13 " data-content="}));"><span class="lineCounter-0-0-12">7</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12">8</span></div><br><div class="line-0-0-13 " data-content="app.get('/', (req, res) => {"><span class="lineCounter-0-0-12">9</span>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="    res.json({"><span class="lineCounter-0-0-12 prim">10</span>    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="        message: &quot;Hello, world!&quot;"><span class="lineCounter-0-0-12">11</span>        message<span class="token operator">:</span> <span class="token string">"Hello, world!"</span></div><br><div class="line-0-0-13 " data-content="    });"><span class="lineCounter-0-0-12">12</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="});"><span class="lineCounter-0-0-12 prim">13</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br></code></pre><p>One problem I had with NodeJS (which I will discuss more under <em>Problems</em>) was modularizing/splitting up my project into multiple files, which further deepened my issue with IDE error-checking and suggestions. Other than those issues, which I am sure I will figure out as time goes on, I had a lot of fun with learning these pieces of technology.</p><h3 id="concepts-learned" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Concepts Learned</h3><p>The <strong>client vs. server</strong> split was one of the first concepts I learned while making this project. Coming into it, I had <em>tiny</em> bit of an idea as to how it worked, but nothing concrete. I think the major takeaway for me was that you have JS on the client <em>and</em> server in a website/NodeJS project, and that the server JS is what could change to other languages (Python =&gt; Django, Java =&gt; Spring). My favorite part of using NodeJS is that you can keep all code inside the same project and use the same languages on both sides, as opposed to leveraging CSS, HTML, JS, <em>and</em> another language like Python or Java. </p><p><strong>API keys</strong> and their usages was something I struggled to comprehend at first, and I had to ask around until I fully figured it out. At this point, I knew the client/server split <em>existed</em>, but not how you were supposed to utilize it. My issue was that, given an API key for a service, <em>how do you secure it while calling the API from the client?</em> The answer is that you <em>don't</em> call the API on the client, but instead abstract it inside your service. The client requests information from the server, the server requests it from the API, and then returns said information back to the client. This might seem obvious, but I didn't realize all website setups (that use require-API-key APIs) did that.</p><p><strong>Asynchronous vs synchronous</strong> was an important concept I didn't fully understand until I used it incorrectly. I knew the difference between them (async = multiple code can run at once, sync = code runs in order), but not how that applies to applications. In NodeJS (&amp; modules), calls being async seemed to be the norm (with sync methods being appended with <code>sync</code>, eg. <code>writeFile</code> and <code>writeFileSync</code>). What do you think happens when the following (theoretical) code is run?</p><pre class="with-bar"><code class="javascript code-0-0-11" tabindex="0"><span class="wmbar-0-0-14"><span></span><span></span><span></span><span></span></span><div class="line-0-0-13 " data-content="fileIO.writeFile(data, location);"><span class="lineCounter-0-0-12 prim">1</span>fileIO<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> location<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="console.log(&quot;Finished writing file at&quot;, location);"><span class="lineCounter-0-0-12 prim">2</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Finished writing file at"</span><span class="token punctuation">,</span> location<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br></code></pre><p>The file writes, then the print displays in console, right? Absolutely &amp; fully wrong. The file writing <em>starts</em>, and moves on to the next line even if it hasn't finished. This normally isn't a problem, but it is a problem if you do something like...</p><pre class="with-bar"><code class="javascript code-0-0-11" tabindex="0"><span class="wmbar-0-0-14"><span></span><span></span><span></span><span></span></span><div class="line-0-0-13 " data-content="fileIO.writeFile(data, location);"><span class="lineCounter-0-0-12 prim">1</span>fileIO<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> location<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="unzipFile(location);"><span class="lineCounter-0-0-12 prim">2</span><span class="token function">unzipFile</span><span class="token punctuation">(</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br></code></pre><p>Now you're trying to unzip a file that doesn't exist, and... yeah, I spent a <em>lot</em> of time figuring this issue out.</p><p>There are 2 solutions to this issue. First, you can use the <code>sync</code> variant of the method (if it exists), which fully runs before calling the next line (normally):</p><pre class="with-bar"><code class="javascript code-0-0-11" tabindex="0"><span class="wmbar-0-0-14"><span></span><span></span><span></span><span></span></span><div class="line-0-0-13 " data-content="fileIO.writeFileSync(data, location);"><span class="lineCounter-0-0-12 prim">1</span>fileIO<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> location<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="unzipFile(location);"><span class="lineCounter-0-0-12 prim">2</span><span class="token function">unzipFile</span><span class="token punctuation">(</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br></code></pre><p>The second option is passing in a callback function (most async methods seemed to support this) which would run after the task was finished:</p><pre class="with-bar"><code class="javascript code-0-0-11" tabindex="0"><span class="wmbar-0-0-14"><span></span><span></span><span></span><span></span></span><div class="line-0-0-13 " data-content="fileIO.writeFileSync(data, location, () => {"><span class="lineCounter-0-0-12 prim">1</span>fileIO<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> location<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="    unzipFile(location);"><span class="lineCounter-0-0-12">2</span>    <span class="token function">unzipFile</span><span class="token punctuation">(</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="});"><span class="lineCounter-0-0-12 prim">3</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><br></code></pre><p>I opted to run most of my logic sync, mostly because I didn't care about the potential async speed benefits (and didn't <em>need</em> to do anything async) after noticing this issue.</p><h3 id="conclusion" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Conclusion</h3><p>This was a project I <em>highly</em> enjoyed making, and it made me re-evaluate my view on website development. Prior to this point, I had always thought web development was more front-end and less logic (and I wanted to work on the processing rather than the design). I quickly realized that this was wrong and that there is much more to do besides making fancy animations and spinning cat images.</p><div class="contentnav-0-0-10" data-no-search=""><a href="#minecraft-mapper" class="h1" data-content-highlight="minecraft-mapper">Minecraft Mapper</a><a href="#design-process" class="h3" data-content-highlight="design-process">Design Process</a><a href="#thoughts-on-tooling" class="h3" data-content-highlight="thoughts-on-tooling">Thoughts on Tooling</a><a href="#concepts-learned" class="h3" data-content-highlight="concepts-learned">Concepts Learned</a><a href="#conclusion" class="h3" data-content-highlight="conclusion">Conclusion</a></div></div><div id="-codedoc-toc" class="toc-0-0-7"><div class="content-0-0-8"><p><a href="/">Home</a></p><div class="collapse-0-0-3 "><script id="IzkwoLmJDJ">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("IzkwoLmJDJ", "gwnm+CCe7YA2A8iWMvc15w==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">Projects</span><span class="icon-font closed">chevron_right</span></div><div class="content"><p><a href="/docs/projects/minecraft-mapper">Minecraft Mapper</a></p></div></div><p><a href="/docs/modding/">Modding</a>
<a href="/docs/tutorials/">Tutorials</a></p><p><br><br></p><p>Want to get in touch with me? You can reach me through my Discord account at Draylar#5035.</p></div></div><div class="footer-0-0-6"><div class="left"><script id="pnio_rvmCP">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("pnio_rvmCP", "mkd0IW9adI8nVPOfeCHzvw==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></div><div class="main"><div class="inside"><a class="watermark-0-0-4" href="https://github.com/CONNECT-platform/codedoc" target="_blank">Created With<svg viewBox="0 0 536 296" version="1.1" xmlns="http://www.w3.org/2000/svg"><g id="codedoc" transform="translate(-244.000000, -364.000000)" fill-rule="nonzero"><path d="M580,532 C615.346224,532 644,560.653776 644,596 C644,631.346224 615.346224,660 580,660 C544.653776,660 516,631.346224 516,596 C516,560.653776 544.653776,532 580,532 Z M716,532 C751.346224,532 780,560.653776 780,596 C780,631.346224 751.346224,660 716,660 L692,660 C687.581722,660 684,656.418278 684,652 C684,647.581722 687.581722,644 692,644 L716,644 C742.509668,644 764,622.509668 764,596 C764,569.490332 742.509668,548 716,548 L692,548 C687.581722,548 684,544.418278 684,540 C684,535.581722 687.581722,532 692,532 L716,532 Z M468,532 C472.418278,532 476,535.581722 476,540 L476,652 C476,656.418278 472.418278,660 468,660 L444,660 C408.653776,660 380,631.346224 380,596 C380,560.653776 408.653776,532 444,532 L468,532 Z M332,532 C336.418278,532 340,535.581722 340,540 L340,652 C340,656.418278 336.418278,660 332,660 L252,660 C247.581722,660 244,656.418278 244,652 L244,540 C244,535.581722 247.581722,532 252,532 L332,532 Z M580,548 C553.490332,548 532,569.490332 532,596 C532,622.509668 553.490332,644 580,644 C606.509668,644 628,622.509668 628,596 C628,569.490332 606.509668,548 580,548 Z M461,548 L444,548 C417.490332,548 396,569.490332 396,596 C396,622.509668 417.490332,644 444,644 L461,644 L461,548 Z M444,364 C479.346224,364 508,392.653776 508,428 C508,463.346224 479.346224,492 444,492 C408.653776,492 380,463.346224 380,428 C380,392.653776 408.653776,364 444,364 Z M332,364 C336.418278,364 340,367.581722 340,372 C340,376.418278 336.418278,380 332,380 L308,380 C281.490332,380 260,401.490332 260,428 C260,454.509668 281.490332,476 308,476 L332,476 C336.418278,476 340,479.581722 340,484 C340,488.418278 336.418278,492 332,492 L308,492 C272.653776,492 244,463.346224 244,428 C244,392.653776 272.653776,364 308,364 L332,364 Z M580,364 C615.346224,364 644,392.653776 644,428 C644,463.346224 615.346224,492 580,492 L556,492 C551.581722,492 548,488.418278 548,484 L548,372 C548,367.581722 551.581722,364 556,364 L580,364 Z M772,364 C776.418278,364 780,367.581722 780,372 C780,376.418278 776.418278,380 772,380 L700,380 L700,420 L772,420 C776.418278,420 780,423.581722 780,428 C780,432.418278 776.418278,436 772,436 L700,436 L700,476 L772,476 C776.418278,476 780,479.581722 780,484 C780,488.418278 776.418278,492 772,492 L692,492 C687.581722,492 684,488.418278 684,484 L684,372 C684,367.581722 687.581722,364 692,364 L772,364 Z M444,380 C417.490332,380 396,401.490332 396,428 C396,454.509668 417.490332,476 444,476 C470.509668,476 492,454.509668 492,428 C492,401.490332 470.509668,380 444,380 Z M580,380 L563,380 L563,476 L580,476 C606.509668,476 628,454.509668 628,428 C628,401.490332 606.509668,380 580,380 Z"></path></g></svg></a></div></div><div class="right"><script id="XODXMvvbng">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("XODXMvvbng", "68IUsjVoDa7JTaO6CyYGjg==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></div></div><script id="hAiSAaKxxQ">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("hAiSAaKxxQ", "7HhdAF30gXWpbtwsT+4gyg==", {"namespace":""});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></body></html>